@model IEnumerable<Emblishment_Management_System.Models.emsDamageItem>
@using Emblishment_Management_System.Common

<table id="table" class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Action</th>
            <th>Damage Category</th>
            <th>Reason</th>
            <th>Damage Qty</th>
            <th>Passed Qty</th>
        </tr>
    </thead>
    <tbody>
        @foreach (Emblishment_Management_System.Models.emsDamageItem emsDamageItem in Model)
        {
            <tr>
                <td>
                    <div>
                        <button type="button" class="btn btn-danger btn-xs glyphicon glyphicon-trash DeleteBtn" id="btnDelete"></button>
                    </div>
                </td>
                <td class="clsRowId" style="display: none;">@emsDamageItem.ID </td>

                <td class="clsSO" style="display: none;">@emsDamageItem.SO </td>
                <td class="clsSGStyle" style="display: none;">@emsDamageItem.SGStyle </td>
                <td class="clsSGComponent" style="display: none;">@emsDamageItem.SGComponent </td>
                <td class="clsDocket" style="display: none;">@emsDamageItem.Docket </td>
                <td class="clsSize" style="display: none;">@emsDamageItem.Size </td>
                <td class="clsDescription">@emsDamageItem.Description </td>
                <td class="clsReasonDescription">@emsDamageItem.ReasonDescription</td>
                <td class="clsDamageQty">@emsDamageItem.DamageQty</td>
                <td class="clsPassedQty">@emsDamageItem.PassedQty</td>
            </tr>
        }
    </tbody>
</table>

<script>
    $(document).ready(function () {
        $(".DeleteBtn").click(function () {

            var $row = $(this).closest("tr");
            var RowNo = $row.find(".clsRowId").text();
            var SO = $row.find(".clsSO").text().trim();
            var SGStyle = $row.find(".clsSGStyle").text().trim();
            var SGComponent = $row.find(".clsSGComponent").text().trim();
            var Docket = $row.find(".clsDocket").text().trim();
            var Size = $row.find(".clsSize").text().trim();

            $.ajax({
                url: '@Url.Action("DeleteDamageItem", "Inspection")',
                type: "POST",
                data: { ID: RowNo, SO: SO, SGStyle: SGStyle, SGComponent: SGComponent, Docket: Docket, Size: Size },
                success: function (result) {
                    $("#divPartialDamageItemView").html(result);
                }
            });


        });
    });
</script>

@if (TempData["Message"] != null)
{
    MessageBox UserMessage = (MessageBox)TempData["Message"];
    @Html.Raw("<script>bootbox.alert('" + UserMessage.Message + "');</script>");
}
